import{u as C}from"./vue-i18n.cjs.f888bd5c.js";import{u as T}from"./index.7b13d60d.js";import{L as N}from"./storage.b628b270.js";import{u as z}from"./index.96594eea.js";import{h as v,r as R,K as U,a9 as m,j as g,k as V,D as l,x as o,l as q,B as y,C as Z,u as i,F as $,Z as j,v as E}from"./vue.543fafcc.js";import{_ as K}from"./_plugin-vue_export-helper.c27b6911.js";import"./_commonjsHelpers.35101cd5.js";import"./request.be218ac0.js";import"./index.899fa70a.js";import"./index.18e5bded.js";import"./themeConfig.ab165958.js";import"./index.4ac74e37.js";import"./index.070d5527.js";import"./index.3b68140d.js";const M={class:"system-role-dialog-container"},P={class:"dialog-footer"},G=v({name:"systemRoleDialog"}),H=v({...G,emits:["refresh"],setup(J,{expose:D,emit:I}){const{t:s}=C(),w=T(),f=z(),p=R(),e=U({fromRules:{name:{required:!0,message:s("message.app.validateName"),pattern:/^[0-9a-zA-Z_.-]*$/,trigger:"blur"},desc:{required:!1,message:s("message.app.desc"),trigger:"blur"}},namespaceList:[],ruleForm:{namespaceId:0,id:0,name:"",desc:""},menuData:[],menuProps:{children:"children",label:"label"},dialog:{isShowDialog:!1,type:"",title:"",submitTxt:""}}),h=async(n,a)=>{var d;(d=p.value)==null||d.clearValidate();let u=await w.getList({page:1,size:30});e.namespaceList=[],u.list.forEach(function(r){e.namespaceList.push({id:r.id,name:r.name})}),n==="update"?(e.ruleForm.name=a.name,e.ruleForm.desc=a.desc,e.ruleForm.id=a.id,e.ruleForm.namespaceId=a.namespaceId,e.dialog.title=s("message.app.editTitle"),e.dialog.submitTxt=s("message.commonBtn.update")):(e.ruleForm.name="",e.ruleForm.desc="",e.ruleForm.namespaceId=N.get("nid"),e.dialog.title=s("message.app.addTitle"),e.dialog.submitTxt=s("message.commonBtn.add")),e.dialog.type=n,e.dialog.isShowDialog=!0},b=()=>{e.dialog.isShowDialog=!1},S=()=>{b()},k=async n=>{!n||await n.validate(a=>{if(a)L();else return!1})},L=async()=>{e.dialog.type==="update"?await f.update({id:e.ruleForm.id,namespaceId:e.ruleForm.namespaceId,desc:e.ruleForm.desc,name:e.ruleForm.name}):await f.add({namespaceId:e.ruleForm.namespaceId,desc:e.ruleForm.desc,name:e.ruleForm.name}),b(),I("refresh")};return D({openDialog:h}),(n,a)=>{const u=m("el-option"),d=m("el-select"),r=m("el-form-item"),c=m("el-col"),_=m("el-row"),F=m("el-input"),A=m("el-form"),x=m("el-button"),B=m("el-dialog");return g(),V("div",M,[l(B,{title:e.dialog.title,modelValue:e.dialog.isShowDialog,"onUpdate:modelValue":a[4]||(a[4]=t=>e.dialog.isShowDialog=t),width:"769px"},{footer:o(()=>[q("span",P,[l(x,{onClick:S,size:"default"},{default:o(()=>[y("取 消")]),_:1}),l(x,{type:"primary",onClick:a[3]||(a[3]=t=>k(p.value)),size:"default"},{default:o(()=>[y(Z(e.dialog.submitTxt),1)]),_:1})])]),default:o(()=>[l(A,{ref_key:"appDialogFormRef",ref:p,model:e.ruleForm,"label-width":"90px",rules:e.fromRules,size:"default"},{default:o(()=>[l(_,null,{default:o(()=>[l(c,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[l(r,{label:i(s)("message.app.namespace"),prop:"namespaceName"},{default:o(()=>[l(d,{modelValue:e.ruleForm.namespaceId,"onUpdate:modelValue":a[0]||(a[0]=t=>e.ruleForm.namespaceId=t),class:"m-2",placeholder:i(s)("message.commonMsg.emptySelect")},{default:o(()=>[(g(!0),V($,null,j(e.namespaceList,t=>(g(),E(u,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),l(_,null,{default:o(()=>[l(c,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[l(r,{label:i(s)("message.app.name"),prop:"name"},{default:o(()=>[l(F,{modelValue:e.ruleForm.name,"onUpdate:modelValue":a[1]||(a[1]=t=>e.ruleForm.name=t),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),l(_,null,{default:o(()=>[l(c,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[l(r,{label:i(s)("message.app.desc"),prop:"desc"},{default:o(()=>[l(F,{modelValue:e.ruleForm.desc,"onUpdate:modelValue":a[2]||(a[2]=t=>e.ruleForm.desc=t),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});const de=K(H,[["__scopeId","data-v-3db5772b"]]);export{de as default};
